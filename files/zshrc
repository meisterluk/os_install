## zsh grml config
source "$HOME/.zshrc.grml"
# handle incompatibilities
unalias up
unalias l

## directories
hash -d go="$HOME/dev/go/src/github.com/meisterluk"

## my personal shorthands
# TODO find PowerShell equivalents
#  d := disk usage information / directory size
#  f := find a file
#  g := search for a substring in text files
#  i := inform me with a message
#  l := list current working directory content
#  m := create folder and change to it
#  o := # open file for viewing/editing or current folder in file explorer
#  t := show file system tree with maxdepth 3
l() { pwd; ls -la }
i() { zenity --info --text "$1" }
d() { df }
f() { find . -iname "$1" }
alias g="rg --color=always -g \!venv"
c() { cd "$1" && find . -maxdepth 1 -type d && echo "\nCurrent working directory: $PWD" }
t() { find . -maxdepth 3 }
m() { if [ -z "$1" ]; then echo "folder name required"; else mkdir "$1" && cd "$1"; fi }
o() {
  if [ -z "$1" ]; then
    thunar "$PWD" &
  else
    if [ -d "$1" ]; then
      thunar "$1" &
    else
      xdg-open "$@"
    fi;
  fi
}

## aliases
alias py="python3"
alias dcl="docker container ls --all"
alias ds="docker exec -it \$(docker container ls | awk 'NR==2{print \$1}') bash"
alias dup="docker-compose up --build --always-recreate-deps --remove-orphans"
alias sile-docker='docker run --volume "$(pwd):/data" --user "$(id -u):$(id -g)" siletypesetter/sile:latest sile'
alias ac="source ./venv/bin/activate"
alias pcat="pygmentize -f terminal256 -O style=native -g"
alias did="vim +'normal Go' +'r!date' ~/did.txt"

## environment variables
export BROWSER="firefox"
export EDITOR="vim"
export LC_ALL="en_US.UTF-8"

export PATH="$PATH:$HOME/bin"

## english vs german keyboard
alias pzthon="python3"
alias geanz="geany"
alias rsznc="rsync --progress"

## functions
encrypt-file () {
    gpg --symmetric --armor "$1"
}
pdfvim() {
    echo "Running vim with PDF options";
    vim -b "$@" -c "set statusline+=%o laststatus=2";
}
exifsetartist() {
  if [ -z "$1" ] || [ -z "$2" ] || [ -z "$3" ] ; then
    echo "usage: exifsetartist <artist> <input.jpg> <output.jpg>";
    exit 2;
  fi
  exif --output="$3" --ifd="EXIF" --tag="Artist" --set-value="$1" "$2"
}
svg2plainsvg() {
  inkscape "$1" --export-text-to-path --export-pdf=/tmp/tmp.pdf
  inkscape -l "${1:r}.plain.svg" /tmp/tmp.pdf
  rm /tmp/tmp.pdf
}
chars() {
  # common unicode symbols
  echo " â™¡ â™¥ â¤ ğŸ’• ğŸ§¡ ğŸ’“ ";
  echo " sup: â°Â¹Â²Â³â´âµâ¶â·â¸â¹ âºâ»â¼â½â¾ á´¬á´®á´°á´±á´³á´´á´µá´¶á´·á´¸á´¹á´ºá´¼á´¾á´¿áµ€áµâ±½áµ‚ ";
  echo " sub: â‚€â‚â‚‚â‚ƒâ‚„â‚…â‚†â‚‡â‚ˆâ‚‰ â‚Šâ‚‹â‚Œâ‚â‚ â‚â‚‘â‚•áµ¢â±¼â‚–â‚—â‚˜â‚™â‚’â‚šáµ£â‚›â‚œáµ¤áµ¥â‚“ ";
  echo " ğŸ˜€ ğŸ˜ ğŸ˜‚ ğŸ˜„ ğŸ˜… ğŸ˜† ğŸ˜ƒ ğŸ˜‡ ğŸ˜‰ ğŸ˜ ğŸ˜Š ğŸ™‚ ğŸ˜ ğŸ˜˜ ğŸ˜™ ğŸ˜š";
  echo " ğŸ˜› ğŸ˜œ ğŸ˜ ğŸ¤“ ğŸ˜¶ ğŸ˜ ğŸ˜‹ ğŸ˜Œ ğŸ˜ˆ ğŸ˜ ğŸ˜’ ğŸ˜“ ğŸ˜” ğŸ˜‘ ğŸ˜— ğŸ˜² ";
  echo " ğŸ˜• ğŸ˜– ğŸ˜ ğŸ˜Ÿ ğŸ¤” ğŸ™ƒ ğŸ‘ ğŸ’© ğŸ–¥ï¸   ğŸ’» âŒ¨ï¸  ğŸ–Šï¸   âœ’ï¸  âœï¸  ğŸ‡¦ ğŸ‡¹  ğŸ‡¯ ğŸ‡µ ";
  echo " Â½ Â¼ Â¾ â… â…‘ â…’ â…“ â…” â…• â…– â…— â…˜ â…™ â…š â…› â…œ â… â… â…Ÿ â†‰ â€° â€± Â© Â® ";
  echo " âŸ· â† â†’ â†“ â†‘ Ã— âœ– â‹® â€¦ Â· ãƒ» Ã· - - â€” â†¤ â†¦ â†§ â†¥ âŸ» âŸ¼ ";
  echo " â‡” â‡ â‡’ â‡“ â‡‘ â€– âŸ¸ âŸ¹  â¤† â¤‡ â‡© â‡§ âŸ½  âŸ¾  âŸº ";
  echo " âˆ€ âˆƒ âˆˆ âˆ‰ âŠ‚ âŠ† âŠ‡ âŠƒ â‹€ âˆ§ â‹ âˆ¨ â‰  â‰¡ â‰¢ â‰… â‰¤ â‰¥ âˆ† âŠ² Â¬ â„š â„• â„¤ â„‚ â„ âˆ âˆ‘ ";
  echo " â€œenâ€ â€˜enâ€™ â€dtâ€œ â€šdtâ€˜ Â«GuillemetsÂ» â€¹frâ€º ã€Šã‚¢ãƒ«ãƒãƒ ã€‹ã€quoteã€‘ã€Œkagikakkoã€  â€  â‚¬ Â£ Â¥ å†† ";
  echo " Î± Î² Î³ Î´ Îµ Î¶ Î· Î¸ Î¹ Îº Î» Î¼ Î½ Î¾ Î¿ Ï€ Ï Ï‚ Ïƒ Ï„ Ï… Ï† Ï‡ Ïˆ Ï‰ ";
  echo " Î‘ Î’ Î“ Î” Î• Î– Î— Î˜ Î™ Îš Î› Îœ Î Î ÎŸ Î  Î¡ Î£ Î¤ Î¥ Î¦ Î§ Î¨ Î© ";
  echo " Ä Ä“ Ä« Å Å« Ã¤ Ã« Ã¯ Ã¶ Ã¼ ÃŸ Ã„ Ã‹ Ã Ã– Ãœ  Â§ â€¦ â™‚ â™€ ";
  echo " âœ“ ğŸ—¸ âœ” âœ”ï¸ â˜‘ï¸ ğŸ—¹ âœ… â» â­• ğŸ—´ ğŸ—™ âŒ â ";
}

syslog() {
  tail -f /var/log/syslog
}
quotes() {
    echo " â€œEnglishâ€ â€˜quotationâ€™ marks "
    echo " â€Deutscheâ€œ (99-66) â€šAnfÃ¼hrungszeichenâ€˜ Â»angefÃ¼hrtÂ« â€ºerklÃ¤rtâ€¹ "
    echo " Â«GuillemetsÂ» "
    echo " TeX: ``english'' and ,,german``. "
}
lastmod() {
    if [[ -z "$1" ]]; then
      find . -exec stat \{\} --printf="%y\n" \; | sort -n -r | head -n 1
    else
      find "$@" -exec stat \{\} --printf="%y\n" \; | sort -n -r | head -n 1
    fi
}
currency-euryen() {
  wget -qO- "http://www.google.com/finance/converter?a=$1&from=eur&to=jpy" |  sed '/res/!d;s/<[^>]*>//g';
}
currency-yeneur() {
  wget -qO- "http://www.google.com/finance/converter?a=$1&from=jpy&to=eur" |  sed '/res/!d;s/<[^>]*>//g';
}
currency-cconv() {
  wget -qO- "http://www.google.com/finance/converter?a=$1&from=$2&to=$3" |  sed '/res/!d;s/<[^>]*>//g';
}
msg() {
  MSG="$1";
  CAPTION="$2";
  if [[ $# -eq 0 ]] then MSG="Hello World"; CAPTION="Hi"; fi
  if [[ $# -eq 1 ]] then CAPTION="$MSG"; fi

  kdialog --caption "$2" --title "$2" --msgbox "$1"
}
wttr () {
  curl -4 http://wttr.in/
}
observe() {
    time "$@" && zenity --info --text="Command finished"
}
webp2png() {
    dwebp "$1" -o "${1:r}.png"
}
mem()
{
    # via https://stackoverflow.com/a/20277787
    ps -eo rss,pid,euser,args:100 --sort %mem | grep -v grep | grep -i $@ | awk '{printf $1/1024 "MB"; $1=""; print }'
}
website-backup() {
    wget --mirror --convert-links --adjust-extension --page-requisites --no-parent "$1"
}
up() {
  [ "${1/[^0-9]/}" == "$1" ] && {
    local ups=""
    for i in $(seq 1 $1); do
      ups=$ups"../"
    done
    cd "$ups"
  } || echo "usage: up INTEGER"
}
